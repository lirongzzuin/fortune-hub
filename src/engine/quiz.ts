import { GenerateResultOutput, SeedContext } from './types';
import { seedIndex, seedPick } from './hash';

// ─── 공통 타입 ────────────────────────────────────────────────────────────────
interface QuizQuestion {
  q: string;
  options: [string, string, string, string]; // options[0] = 정답 (표시 시 셔플)
}

// ─── 퀴즈 메타 정보 ───────────────────────────────────────────────────────────
export const QUIZ_META: Record<string, { title: string; emoji: string; hashtag: string }> = {
  'one-minute-quiz':      { title: '1분 상식 퀴즈',   emoji: '🧠', hashtag: '#상식퀴즈' },
  'physics-quiz':         { title: '1분 물리 퀴즈',   emoji: '⚛️', hashtag: '#물리퀴즈' },
  'chemistry-quiz':       { title: '1분 화학 퀴즈',   emoji: '🧪', hashtag: '#화학퀴즈' },
  'biology-quiz':         { title: '1분 생물 퀴즈',   emoji: '🔬', hashtag: '#생물퀴즈' },
  'world-capitals-quiz':  { title: '1분 세계 수도 퀴즈', emoji: '🗺️', hashtag: '#수도퀴즈' },
  'world-history-quiz':   { title: '1분 세계사 퀴즈', emoji: '📜', hashtag: '#세계사퀴즈' },
};

// ─── 상식 퀴즈 문제 풀 (30문제) ────────────────────────────────────────────────
const GENERAL_POOL: QuizQuestion[] = [
  { q: '대한민국의 수도는?', options: ['서울', '부산', '대전', '인천'] },
  { q: '물의 화학식은?', options: ['H₂O', 'CO₂', 'NaCl', 'O₂'] },
  { q: '지구에서 가장 큰 대양은?', options: ['태평양', '대서양', '인도양', '북극해'] },
  { q: '빛의 3원색이 아닌 것은?', options: ['노란색', '빨간색', '초록색', '파란색'] },
  { q: '1년은 몇 주인가?', options: ['52주', '48주', '56주', '50주'] },
  { q: '커피 원두의 원산지로 알려진 나라는?', options: ['에티오피아', '브라질', '콜롬비아', '베트남'] },
  { q: '인체에서 가장 큰 장기는?', options: ['피부', '간', '폐', '뇌'] },
  { q: 'DNA의 이중나선 구조를 발견한 사람은?', options: ['왓슨과 크릭', '뉴턴', '아인슈타인', '다윈'] },
  { q: '세계에서 가장 긴 강은?', options: ['나일강', '아마존강', '양쯔강', '미시시피강'] },
  { q: '한글을 창제한 왕은?', options: ['세종대왕', '태종', '영조', '정조'] },
  { q: '올림픽은 몇 년마다 열리나?', options: ['4년', '2년', '3년', '5년'] },
  { q: '지구의 자전 주기는?', options: ['약 24시간', '약 12시간', '약 48시간', '약 36시간'] },
  { q: '대한민국의 국화는?', options: ['무궁화', '장미', '벚꽃', '진달래'] },
  { q: '바이러스와 세균 중 항생제가 효과 있는 것은?', options: ['세균', '바이러스', '둘 다', '둘 다 아님'] },
  { q: '태양계에서 가장 큰 행성은?', options: ['목성', '토성', '해왕성', '천왕성'] },
  { q: '셰익스피어의 4대 비극이 아닌 것은?', options: ['로미오와 줄리엣', '햄릿', '오셀로', '맥베스'] },
  { q: '피타고라스 정리: 빗변의 제곱은?', options: ['나머지 두 변의 제곱의 합', '나머지 두 변의 곱', '나머지 두 변의 합', '나머지 두 변의 제곱의 곱'] },
  { q: '비타민C가 풍부한 과일은?', options: ['키위', '바나나', '사과', '포도'] },
  { q: '세계에서 인구가 가장 많은 나라는?', options: ['인도', '중국', '미국', '인도네시아'] },
  { q: '음속보다 빠른 것은?', options: ['빛', '소리', '같다', '상황에 따라 다름'] },
  { q: '원소 기호 Fe는 무엇인가?', options: ['철', '금', '은', '구리'] },
  { q: '모차르트의 출생 국가는?', options: ['오스트리아', '독일', '이탈리아', '프랑스'] },
  { q: 'WWW는 무엇의 약자인가?', options: ['World Wide Web', 'Western World Web', 'Wide World Web', 'World Web Wide'] },
  { q: '한반도에서 가장 높은 산은?', options: ['백두산', '한라산', '지리산', '설악산'] },
  { q: '삼국시대의 세 나라가 아닌 것은?', options: ['가야', '고구려', '백제', '신라'] },
  { q: '달에 처음 발을 디딘 사람은?', options: ['닐 암스트롱', '버즈 올드린', '유리 가가린', '앨런 셰퍼드'] },
  { q: '세계에서 가장 작은 나라는?', options: ['바티칸', '모나코', '산마리노', '리히텐슈타인'] },
  { q: '공기 중 가장 많은 기체는?', options: ['질소', '산소', '이산화탄소', '아르곤'] },
  { q: '한국의 전통 발효 식품이 아닌 것은?', options: ['초밥', '김치', '된장', '젓갈'] },
  { q: '노벨상을 제정한 사람 알프레드 노벨의 발명품은?', options: ['다이너마이트', '전화기', '전구', '증기기관'] },
];

// ─── 물리 퀴즈 문제 풀 (30문제) ───────────────────────────────────────────────
const PHYSICS_POOL: QuizQuestion[] = [
  { q: '뉴턴의 제1법칙을 무엇이라 부르는가?', options: ['관성의 법칙', '작용반작용의 법칙', '가속도의 법칙', '만유인력의 법칙'] },
  { q: '빛의 속도는 진공에서 약 얼마인가?', options: ['약 30만 km/s', '약 3만 km/s', '약 3000만 km/s', '약 300 km/s'] },
  { q: '전기저항의 단위는?', options: ['옴(Ω)', '볼트(V)', '암페어(A)', '와트(W)'] },
  { q: '소리가 가장 빠르게 전달되는 매질은?', options: ['고체', '액체', '기체', '진공'] },
  { q: '반사의 법칙에서 입사각과 반사각의 관계는?', options: ['같다', '반사각이 더 크다', '입사각이 더 크다', '관계없다'] },
  { q: '운동에너지 공식은? (m=질량, v=속도)', options: ['½mv²', 'mv', 'mv²', '2mv²'] },
  { q: '절대온도 0K는 섭씨 약 몇 도인가?', options: ['-273°C', '-173°C', '-100°C', '-373°C'] },
  { q: '전력(W)의 공식은? (V=전압, I=전류)', options: ['V×I', 'V/I', 'V+I', 'V²×I'] },
  { q: '물이 공기 중으로 나올 때 빛의 굴절 방향은?', options: ['법선에서 멀어진다', '법선에 가까워진다', '굴절하지 않는다', '전반사만 일어난다'] },
  { q: '옴의 법칙에서 전류 I = ?', options: ['V/R', 'V×R', 'R/V', 'V²/R'] },
  { q: '지구의 중력가속도는 약 얼마인가?', options: ['9.8 m/s²', '8.9 m/s²', '10.8 m/s²', '11.2 m/s²'] },
  { q: '핵분열과 핵융합 중 태양에서 에너지를 내는 것은?', options: ['핵융합', '핵분열', '둘 다 동일', '핵분열→핵융합 순서'] },
  { q: '파동의 속도 = ?', options: ['진동수 × 파장', '진동수 / 파장', '파장 / 진동수', '진동수 + 파장'] },
  { q: '도플러 효과란?', options: ['파원이 움직일 때 관측 진동수가 변하는 현상', '빛이 굴절하는 현상', '소리가 흡수되는 현상', '전자기파 간섭 현상'] },
  { q: '보일의 법칙은 어떤 관계인가?', options: ['(일정 온도) 압력과 부피는 반비례', '온도와 부피의 관계', '온도와 압력의 관계', '질량과 부피의 관계'] },
  { q: '렌즈에서 빛을 모으는(수렴) 것은?', options: ['볼록렌즈', '오목렌즈', '평면렌즈', '프리즘'] },
  { q: '가속도의 단위는?', options: ['m/s²', 'm/s', 'kg·m/s', 'N/m'] },
  { q: '열역학 제1법칙이 설명하는 것은?', options: ['에너지 보존 법칙', '엔트로피 증가', '열은 온도 차에 비례', '절대영도 불가'] },
  { q: '방사선에서 종이 한 장도 투과 못하는 것은?', options: ['알파(α)선', '베타(β)선', '감마(γ)선', '엑스(X)선'] },
  { q: '진자의 주기는 무엇에 관계 있는가?', options: ['줄의 길이', '추의 질량', '최대 진폭', '진자의 재질'] },
  { q: '전자기유도 법칙을 발견한 사람은?', options: ['패러데이', '뉴턴', '맥스웰', '볼타'] },
  { q: '속도와 속력의 차이는?', options: ['속도는 방향 있고 속력은 없다(벡터 vs 스칼라)', '속력은 방향 있고 속도는 없다', '같은 말이다', '단위가 다를 뿐이다'] },
  { q: '중성자를 발견한 사람은?', options: ['채드윅', '러더퍼드', '보어', '톰슨'] },
  { q: '빛의 간섭 현상이 증명하는 것은?', options: ['빛의 파동성', '빛의 입자성', '빛의 직진성', '빛의 반사성'] },
  { q: '마찰이 없는 수평면에서 물체에 힘을 가하지 않으면?', options: ['등속도 운동을 한다', '점점 빨라진다', '점점 느려진다', '즉시 멈춘다'] },
  { q: '전기저항이 감소하는 경우는?', options: ['도선의 단면적이 넓어질 때', '도선의 길이가 길어질 때', '온도가 올라갈 때(금속)', '도선이 가늘어질 때'] },
  { q: '뉴턴의 제3법칙(작용-반작용)의 내용은?', options: ['A가 B에 힘을 가하면 B도 A에 같은 크기의 힘을 반대 방향으로 가한다', 'F = ma', '관성의 법칙', '가속도는 힘에 비례한다'] },
  { q: 'E = mc²에서 c는 무엇인가?', options: ['빛의 속도', '전하량', '전류', '열에너지'] },
  { q: '오목거울의 특징은?', options: ['빛을 한 점으로 모은다(수렴)', '빛을 퍼뜨린다(발산)', '빛을 그대로 투과시킨다', '굴절만 일어난다'] },
  { q: '반도체의 전기 전도성은?', options: ['도체와 절연체의 중간', '도체보다 높다', '절연체보다 낮다', '온도와 무관하다'] },
];

// ─── 화학 퀴즈 문제 풀 (30문제) ───────────────────────────────────────────────
const CHEMISTRY_POOL: QuizQuestion[] = [
  { q: '원소 주기율표를 만든 사람은?', options: ['멘델레예프', '라부아지에', '보일', '돌턴'] },
  { q: '산성 용액의 pH는?', options: ['7 미만', '7 초과', '정확히 7', '14'] },
  { q: '소금(식염)의 화학식은?', options: ['NaCl', 'KCl', 'Na₂O', 'HCl'] },
  { q: '이산화탄소의 화학식은?', options: ['CO₂', 'CO', 'C₂O', 'C₂O₂'] },
  { q: '원자핵을 구성하는 입자는?', options: ['양성자와 중성자', '전자와 양성자', '전자와 중성자', '양성자만'] },
  { q: '금속 원소가 아닌 것은?', options: ['황(S)', '철(Fe)', '금(Au)', '구리(Cu)'] },
  { q: '물을 전기분해할 때 음극(-)에서 발생하는 기체는?', options: ['수소(H₂)', '산소(O₂)', '질소(N₂)', '이산화탄소(CO₂)'] },
  { q: '산과 염기가 반응하면 무엇이 일어나는가?', options: ['중화반응(물과 염 생성)', '환원반응', '산화반응', '분해반응'] },
  { q: '전자를 공유하는 화학 결합은?', options: ['공유결합', '이온결합', '금속결합', '수소결합'] },
  { q: '원자 번호 1번 원소는?', options: ['수소(H)', '헬륨(He)', '리튬(Li)', '탄소(C)'] },
  { q: '염산의 화학식은?', options: ['HCl', 'H₂SO₄', 'HNO₃', 'H₂O₂'] },
  { q: '주기율표에서 같은 족 원소의 특징은?', options: ['화학적 성질이 비슷하다', '원자량이 같다', '전자 수가 같다', '중성자 수가 같다'] },
  { q: '탄소 원자의 최외각 전자 수는?', options: ['4개', '2개', '6개', '8개'] },
  { q: '산화-환원 반응에서 전자를 잃는 것은?', options: ['산화', '환원', '중화', '분해'] },
  { q: '아보가드로 수는?', options: ['6.022×10²³', '6.022×10²²', '6.022×10²⁴', '6.022×10²¹'] },
  { q: '반응 시 에너지를 방출하는 것은?', options: ['발열반응', '흡열반응', '연쇄반응', '환원반응'] },
  { q: '원소 기호 Au는?', options: ['금(Gold)', '은(Silver)', '구리(Copper)', '알루미늄(Aluminum)'] },
  { q: '암모니아의 화학식은?', options: ['NH₃', 'NO₂', 'N₂O', 'N₂H₄'] },
  { q: '비활성 기체(18족)의 특징은?', options: ['최외각 전자가 8개(또는 2개)로 안정적이어서 반응 거의 안 함', '반응성이 강하다', '모두 금속이다', '상온에서 모두 액체이다'] },
  { q: '상온에서 액체인 금속 원소는?', options: ['수은(Hg)', '금(Au)', '은(Ag)', '철(Fe)'] },
  { q: '황산의 화학식은?', options: ['H₂SO₄', 'H₂SO₃', 'H₂S', 'HSO₄'] },
  { q: '방사성 붕괴에서 알파(α) 입자의 정체는?', options: ['헬륨 원자핵(양성자 2+중성자 2)', '전자', '양성자만', '중성자만'] },
  { q: '유기화합물의 기준이 되는 원소는?', options: ['탄소(C)', '산소(O)', '수소(H)', '질소(N)'] },
  { q: '르 샤틀리에의 원리가 설명하는 것은?', options: ['평형 이동 방향 예측', '산화환원 방향 예측', '용해도 법칙', '기체 이상 법칙'] },
  { q: '오존(O₃)이 인체에 중요한 이유는?', options: ['자외선을 흡수해 생물 보호', '산소보다 호흡에 좋다', '온실효과를 막는다', '산성비를 중화한다'] },
  { q: '동위원소란?', options: ['양성자 수는 같고 중성자 수가 다른 원소', '전자 수가 다른 원소', '원자량이 같은 다른 원소', '같은 원소의 동소체'] },
  { q: '화학평형에서 촉매의 역할은?', options: ['활성화 에너지를 낮춰 반응속도를 높인다', '생성물의 양을 늘린다', '평형을 이동시킨다', '반응물을 분해한다'] },
  { q: '산성비의 주요 원인 물질은?', options: ['이산화황(SO₂)과 질소산화물(NOₓ)', '이산화탄소(CO₂)', '오존(O₃)', '메테인(CH₄)'] },
  { q: '전해질이란?', options: ['물에 녹아 이온을 만들어 전기가 통하는 물질', '전기를 전혀 통하지 않는 물질', '금속으로 이루어진 물질', '분자로만 이루어진 물질'] },
  { q: '화학반응식에서 보존되는 것은?', options: ['원자의 종류와 수(질량 보존)', '분자의 수', '부피', '반응 속도'] },
];

// ─── 생물 퀴즈 문제 풀 (30문제) ───────────────────────────────────────────────
const BIOLOGY_POOL: QuizQuestion[] = [
  { q: '세포의 에너지 공장이라 불리는 세포 소기관은?', options: ['미토콘드리아', '핵', '리보솜', '소포체'] },
  { q: '광합성이 일어나는 세포 소기관은?', options: ['엽록체', '미토콘드리아', '세포막', '리소좀'] },
  { q: 'DNA를 구성하는 염기가 아닌 것은?', options: ['유라실(U)', '아데닌(A)', '구아닌(G)', '사이토신(C)'] },
  { q: '진화론을 주장한 사람은?', options: ['찰스 다윈', '그레고어 멘델', '루이 파스퇴르', '알렉산더 플레밍'] },
  { q: '사람의 체세포 염색체 수는?', options: ['46개', '23개', '48개', '44개'] },
  { q: '세포막의 주요 구성 성분은?', options: ['인지질 이중층', '셀룰로오스', '단백질만', 'DNA'] },
  { q: '눈의 망막에서 색을 감지하는 세포는?', options: ['원추세포', '간상세포', '신경절세포', '상피세포'] },
  { q: '혈액에서 산소를 운반하는 것은?', options: ['적혈구(헤모글로빈)', '백혈구', '혈소판', '혈장'] },
  { q: '멘델의 유전법칙 중 "우열의 법칙"이란?', options: ['F₁에서 우성 형질만 나타난다', '형질이 3:1로 분리된다', '유전자가 독립적으로 분리된다', '형질이 섞인다'] },
  { q: '생식세포를 만드는 세포분열은?', options: ['감수분열', '체세포분열', '유사분열', '이분법'] },
  { q: '바이러스의 특징은?', options: ['세포 구조가 없다', '세포막이 있다', '핵막이 있다', '스스로 분열한다'] },
  { q: '단백질을 분해하는 소화효소는?', options: ['펩신(위)', '아밀라아제(침)', '리파아제(지방)', '수크라아제(설탕)'] },
  { q: '혈액 순환에서 폐순환 경로는?', options: ['심장→폐→심장', '심장→온몸→심장', '폐→온몸→폐', '심장→신장→심장'] },
  { q: '신경계의 기본 단위인 신경세포는?', options: ['뉴런', '시냅스', '축삭', '수상돌기'] },
  { q: '유전자의 본체는?', options: ['DNA', 'RNA', '단백질', '지질'] },
  { q: '사람 심장의 방(챔버) 수는?', options: ['4개', '2개', '3개', '1개'] },
  { q: '항원-항체 면역 반응을 주도하는 혈액 세포는?', options: ['백혈구(림프구)', '적혈구', '혈소판', '혈장'] },
  { q: '세포 호흡(유기호흡)의 최종 산물은?', options: ['CO₂와 H₂O', 'O₂와 글루코스', 'ATP만', 'N₂와 H₂O'] },
  { q: '단백질 합성이 일어나는 세포 소기관은?', options: ['리보솜', '미토콘드리아', '핵', '골지체'] },
  { q: '생태계에서 광합성을 통해 유기물을 만드는 생물은?', options: ['생산자(식물)', '소비자(초식동물)', '소비자(육식동물)', '분해자'] },
  { q: '혈당량을 낮추는 호르몬은?', options: ['인슐린', '글루카곤', '아드레날린', '갑상선호르몬'] },
  { q: '식물의 증산작용이 일어나는 곳은?', options: ['잎의 기공', '뿌리털', '줄기 내부', '꽃잎'] },
  { q: 'ABO식 혈액형에서 O형의 유전자형은?', options: ['OO', 'AO', 'BO', 'AB'] },
  { q: '광합성의 명반응에서 생성되는 것은?', options: ['ATP와 NADPH', '포도당', '이산화탄소', '엽록소'] },
  { q: '기관지 끝에 있는 공기주머니는?', options: ['폐포', '기관', '후두', '인두'] },
  { q: '성장호르몬은 어디서 분비되는가?', options: ['뇌하수체', '부신', '갑상선', '췌장'] },
  { q: '세포벽이 있는 세포는?', options: ['식물 세포', '동물 세포', '신경 세포', '근육 세포'] },
  { q: 'RNA와 DNA의 차이점은?', options: ['RNA는 단일 가닥이며 유라실(U)을 포함', 'RNA는 이중 나선 구조', 'RNA에는 티민(T)이 있다', 'DNA가 더 짧다'] },
  { q: '수분이 식물의 뿌리에서 잎까지 이동하는 통로는?', options: ['물관(도관)', '체관', '형성층', '코르크층'] },
  { q: '포식자와 피식자 관계에서 피식자가 늘면 포식자는?', options: ['증가한다', '감소한다', '변하지 않는다', '멸종한다'] },
];

// ─── 세계 수도 퀴즈 문제 풀 (30문제) ─────────────────────────────────────────
const CAPITALS_POOL: QuizQuestion[] = [
  { q: '미국의 수도는?', options: ['워싱턴 D.C.', '뉴욕', '로스앤젤레스', '시카고'] },
  { q: '영국의 수도는?', options: ['런던', '맨체스터', '버밍엄', '리버풀'] },
  { q: '프랑스의 수도는?', options: ['파리', '마르세유', '리옹', '보르도'] },
  { q: '독일의 수도는?', options: ['베를린', '뮌헨', '함부르크', '프랑크푸르트'] },
  { q: '일본의 수도는?', options: ['도쿄', '오사카', '교토', '나고야'] },
  { q: '중국의 수도는?', options: ['베이징', '상하이', '광저우', '선전'] },
  { q: '러시아의 수도는?', options: ['모스크바', '상트페테르부르크', '노보시비르스크', '예카테린부르크'] },
  { q: '호주의 수도는?', options: ['캔버라', '시드니', '멜버른', '브리즈번'] },
  { q: '캐나다의 수도는?', options: ['오타와', '토론토', '밴쿠버', '몬트리올'] },
  { q: '브라질의 수도는?', options: ['브라질리아', '리우데자네이루', '상파울루', '살바도르'] },
  { q: '인도의 수도는?', options: ['뉴델리', '뭄바이', '콜카타', '벵갈루루'] },
  { q: '이탈리아의 수도는?', options: ['로마', '밀라노', '나폴리', '피렌체'] },
  { q: '스페인의 수도는?', options: ['마드리드', '바르셀로나', '발렌시아', '세비야'] },
  { q: '아르헨티나의 수도는?', options: ['부에노스아이레스', '코르도바', '로사리오', '멘도사'] },
  { q: '이집트의 수도는?', options: ['카이로', '알렉산드리아', '기자', '룩소르'] },
  { q: '터키의 수도는?', options: ['앙카라', '이스탄불', '이즈미르', '부르사'] },
  { q: '멕시코의 수도는?', options: ['멕시코시티', '과달라하라', '몬테레이', '티후아나'] },
  { q: '네덜란드의 공식 수도는?', options: ['암스테르담', '로테르담', '헤이그', '위트레흐트'] },
  { q: '스위스의 수도는?', options: ['베른', '취리히', '제네바', '바젤'] },
  { q: '스웨덴의 수도는?', options: ['스톡홀름', '예테보리', '말뫼', '우메오'] },
  { q: '노르웨이의 수도는?', options: ['오슬로', '베르겐', '트론헤임', '스타방에르'] },
  { q: '포르투갈의 수도는?', options: ['리스본', '포르투', '브라가', '코임브라'] },
  { q: '그리스의 수도는?', options: ['아테네', '테살로니키', '파트라', '이라클리온'] },
  { q: '사우디아라비아의 수도는?', options: ['리야드', '제다', '메카', '메디나'] },
  { q: '뉴질랜드의 수도는?', options: ['웰링턴', '오클랜드', '크라이스트처치', '더니든'] },
  { q: '인도네시아의 수도는?', options: ['자카르타', '수라바야', '반둥', '메단'] },
  { q: '태국의 수도는?', options: ['방콕(끄룽텝)', '치앙마이', '파타야', '푸켓'] },
  { q: '베트남의 수도는?', options: ['하노이', '호치민시', '다낭', '후에'] },
  { q: '폴란드의 수도는?', options: ['바르샤바', '크라쿠프', '우치', '브로츠와프'] },
  { q: '이란의 수도는?', options: ['테헤란', '이스파한', '시라즈', '타브리즈'] },
];

// ─── 세계사 퀴즈 문제 풀 (30문제) ────────────────────────────────────────────
const HISTORY_POOL: QuizQuestion[] = [
  { q: '제1차 세계대전이 시작된 해는?', options: ['1914년', '1918년', '1910년', '1920년'] },
  { q: '프랑스 혁명이 일어난 해는?', options: ['1789년', '1799년', '1776년', '1800년'] },
  { q: '미국 독립선언서가 채택된 해는?', options: ['1776년', '1789년', '1781년', '1783년'] },
  { q: '러시아 혁명이 일어난 해는?', options: ['1917년', '1905년', '1914년', '1920년'] },
  { q: '제2차 세계대전이 종전된 해는?', options: ['1945년', '1943년', '1944년', '1946년'] },
  { q: '베를린 장벽이 무너진 해는?', options: ['1989년', '1991년', '1985년', '1990년'] },
  { q: '콜럼버스가 아메리카에 도착한 해는?', options: ['1492년', '1498년', '1488년', '1500년'] },
  { q: '로마 제국이 동서로 분열된 해는?', options: ['395년', '476년', '284년', '313년'] },
  { q: '십자군 원정의 주요 목적은?', options: ['이슬람에 빼앗긴 예루살렘 성지 탈환', '이슬람 문화 습득', '동방 무역로 개척', '이탈리아 통일'] },
  { q: '마르틴 루터가 종교개혁을 시작한 해는?', options: ['1517년', '1527년', '1509년', '1555년'] },
  { q: '냉전의 상징 베를린 장벽이 세워진 해는?', options: ['1961년', '1956년', '1948년', '1968년'] },
  { q: '오스만 제국의 수도는?', options: ['콘스탄티노플(이스탄불)', '앙카라', '바그다드', '카이로'] },
  { q: '잔 다르크가 활약한 전쟁은?', options: ['백년전쟁', '십자군전쟁', '장미전쟁', '30년전쟁'] },
  { q: '흑사병(페스트)이 유럽에서 크게 유행한 시기는?', options: ['14세기(1300년대)', '11세기', '16세기', '18세기'] },
  { q: '메이지유신이 일어난 나라는?', options: ['일본', '중국', '조선', '베트남'] },
  { q: 'UN(국제연합)이 설립된 해는?', options: ['1945년', '1919년', '1939년', '1950년'] },
  { q: '제1차 세계대전의 도화선이 된 사건은?', options: ['오스트리아 황태자 프란츠 페르디난트 암살', '독일의 벨기에 침공', '오스트리아의 세르비아 선전포고', '러시아의 동원령'] },
  { q: '인도가 영국으로부터 독립한 해는?', options: ['1947년', '1945년', '1950년', '1919년'] },
  { q: '소련이 해체된 해는?', options: ['1991년', '1989년', '1985년', '1993년'] },
  { q: '중화인민공화국이 수립된 해는?', options: ['1949년', '1945년', '1911년', '1937년'] },
  { q: '달에 인류가 처음 발을 디딘 해는?', options: ['1969년', '1961년', '1967년', '1972년'] },
  { q: '마그나카르타가 서명된 해는?', options: ['1215년', '1066년', '1381년', '1265년'] },
  { q: '나폴레옹이 황제로 즉위한 해는?', options: ['1804년', '1799년', '1789년', '1815년'] },
  { q: '아편전쟁의 교전국은?', options: ['청나라와 영국', '청나라와 미국', '일본과 영국', '청나라와 프랑스'] },
  { q: '고대 올림픽이 열렸던 도시는?', options: ['올림피아', '아테네', '스파르타', '코린트'] },
  { q: '베트남 전쟁에서 미군이 철수 협정을 맺은 해는?', options: ['1973년', '1969년', '1975년', '1971년'] },
  { q: '로마의 초대 황제는?', options: ['아우구스투스(옥타비아누스)', '율리우스 카이사르', '네로', '콘스탄티누스'] },
  { q: '미국의 노예해방선언이 발표된 해는?', options: ['1863년', '1865년', '1861년', '1870년'] },
  { q: '명나라를 멸망시키고 중국을 통일한 왕조는?', options: ['청나라', '원나라', '한나라', '송나라'] },
  { q: '르네상스가 최초로 발생한 지역은?', options: ['이탈리아', '프랑스', '독일', '영국'] },
];

// ─── 슬러그별 문제 풀 매핑 ───────────────────────────────────────────────────
const QUIZ_POOLS: Record<string, QuizQuestion[]> = {
  'one-minute-quiz':      GENERAL_POOL,
  'physics-quiz':         PHYSICS_POOL,
  'chemistry-quiz':       CHEMISTRY_POOL,
  'biology-quiz':         BIOLOGY_POOL,
  'world-capitals-quiz':  CAPITALS_POOL,
  'world-history-quiz':   HISTORY_POOL,
};

/**
 * 날짜 시드 + 슬러그 기반으로 30문제 중 10문항 무작위 선택
 */
export function getDailyQuizQuestions(seed: SeedContext, slug = 'one-minute-quiz') {
  const pool = QUIZ_POOLS[slug] ?? GENERAL_POOL;
  const selected = seedPick(pool, seed.daySeed, 10, 0);

  return selected.map((item, i) => {
    const correctAnswer = item.options[0];
    const shuffledOptions = [...item.options] as string[];

    // 시드 기반 셔플 (정답 위치 무작위화)
    for (let j = shuffledOptions.length - 1; j > 0; j--) {
      const k = seedIndex(seed.daySeed, j + 1, i * 100 + j);
      [shuffledOptions[j], shuffledOptions[k]] = [shuffledOptions[k], shuffledOptions[j]];
    }

    return {
      id: `quiz_${i}`,
      question: item.q,
      options: shuffledOptions,
      correctIndex: shuffledOptions.indexOf(correctAnswer),
    };
  });
}

/**
 * 퀴즈 결과 생성 (슬러그별 제목 포함)
 */
export function generateQuizResult(
  score: number,
  total: number,
  seed: SeedContext,
  slug = 'one-minute-quiz',
): GenerateResultOutput {
  const pct = Math.round((score / total) * 100);
  const meta = QUIZ_META[slug] ?? QUIZ_META['one-minute-quiz'];

  let grade: string;
  let comment: string;
  if (pct >= 90) {
    grade = '천재급';
    comment = '거의 완벽한 점수다! 오늘 자신감을 갖고 하루를 보내도 좋다.';
  } else if (pct >= 70) {
    grade = '우등생';
    comment = '탄탄한 기본기가 느껴진다. 조금만 더 다듬으면 만점도 가능하다.';
  } else if (pct >= 50) {
    grade = '평균 이상';
    comment = '나쁘지 않은 결과다. 관심 분야를 더 넓혀보면 어떨까?';
  } else if (pct >= 30) {
    grade = '분발 필요';
    comment = '아직 성장의 여지가 많다. 하나씩 알아가는 재미를 느껴보자.';
  } else {
    grade = '도전자';
    comment = '오늘의 점수는 시작일 뿐이다. 내일 다시 도전해보자!';
  }

  const shareText = `${meta.emoji} ${meta.title}\n${score}/${total} 정답 (${pct}%) - ${grade}\n${meta.hashtag} #소확잼`;

  return {
    resultKey: `${slug}-${seed.dateStr}-${score}`,
    summary: `${total}문항 중 ${score}개 정답 (${pct}%) — ${grade}`,
    keywords: [grade, `${pct}%`, meta.hashtag.replace('#', '')],
    doToday: '궁금한 분야 위키피디아를 하나 읽어보자.',
    avoidToday: '아는 척은 잠시 내려놓자.',
    detailSections: [
      {
        area: 'score',
        label: '점수',
        emoji: '📊',
        text: `${score} / ${total} (${pct}%)`,
        score: Math.ceil(pct / 20),
      },
      {
        area: 'grade',
        label: '등급',
        emoji: '🏅',
        text: grade,
      },
      {
        area: 'comment',
        label: '한마디',
        emoji: '💬',
        text: comment,
      },
      {
        area: 'challenge',
        label: '도전',
        emoji: '🎯',
        text: '친구에게 공유하고 누가 더 잘 맞추나 경쟁해보세요!',
      },
    ],
    personalDetail: '같은 날에는 같은 문제가 출제됩니다. 친구와 점수를 비교해보세요!',
    shareCard: {
      title: meta.title,
      summary: shareText,
      keywords: [grade, `${pct}%`, meta.hashtag],
    },
    meta: {
      disclaimer: false,
      generatedAt: seed.dateStr,
    },
  };
}
